{% extends 'SpoutletBundle::layout.html.twig' %}

{% block title 'Groups - ' ~ group.name %}

{# block open_graph %}
    <meta property="fb:app_id" content="{{ facebook_app_id }}">
    <meta property="og:title" content="{{ gamePage.game.name }}" />
    <meta property="og:type" content="game" />
    <meta property="og:url" content="{{ app.request.getUri }}" />
    <meta property="og:site_name" content="Alienware Arena" />
    {% if gamePage.openGraphOverride %}
        {% if gamePage.openGraphOverride.thumbnail %}
            {% set thumbUrl = media_path(gamePage.openGraphOverride.thumbnail) %}
            <meta property="og:image" content="{{ thumbUrl }}" />
        {% endif %}
        {% if gamePage.openGraphOverride.description %}
            <meta property="og:description" content="{{ gamePage.openGraphOverride.description | striptags }}" />
        {% endif %}
    {% endif %}
{% endblock #}

{# either set the custom background image, or leave it to false #}
{% if group.backgroundImage %}
    {% set customPageBackgroundImage = media_path(group.backgroundImage) %}
{% else %}
    {% set customPageBackgroundImage = false %}
{% endif %}

{% set inviteThumb = app.request.getScheme ~ '://' ~ app.request.getHost ~ '/bundles/spoutlet/images/groups/groups_og.jpg' %}

{% block page_background_image customPageBackgroundImage %}

{% block content %}
    <div class="game-show-page">
        <div class="std_2col">
            <div class="right">
                {% include 'SpoutletBundle:Default:_dealsAd.html.twig' %}
                {% if group.location and group.category == 'location' %}
                    <input id="location-value" type="hidden" value="{{ group.location.getFormattedLocation }}" />
                    <div id="google-map-location" style="width: 300px; height: 250px; margin: 10px auto;"></div>
                {% endif %}
            </div>
            <div class="left">
                <div class="fb-like" data-send="false" data-width="450" data-show-faces="false" data-colorscheme="dark"></div>
                <div id="fb-group-invite">
                    <a href="#" id="group-invite">Invite Friends</a>
                </div>
                <div class="content">
                    <h1>Name</h1>
                    <p style="margin-left: 25px;">{{ group.name }}</p>
                    <h1>Group Avatar</h1>
                    <p style="margin-left: 25px;">
                        {% if group.groupAvatar %}
                            <img src="{{ media_path(group.groupAvatar, {'local': true}) | imagine_filter('image_thumb') }}" />
                        {% else %}
                            [None Set]
                        {% endif %}
                    </p>
                    <h1>Description</h1>
                    <p style="margin-left: 25px;">{{ group.description }}</p>
                    <h1>How To Join</h1>
                    <p style="margin-left: 25px;">{{ group.howToJoin }}</p>
                    <h1>Public?</h1>
                    <p style="margin-left: 25px;">{{ group.isPublic ? 'Public' : 'Private' }}</p>
                </div>
            </div>
        </div>
        <div class="clear">&nbsp;</div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% if group.location and group.category == 'location' %}
        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key={{ google_api_key }}&sensor=true"></script>
        <script type="text/javascript" src="/bundles/spoutlet/js/jquery.groupsmaps.js"></script>
        <script type="text/javascript">
            $(function () {
                $('#google-map-location').groupsmap({
                    address : $('#location-value').val()
                });
            });
        </script>
    {% endif %}
    <script type="text/javascript">
        $(function () {

            $('#group-invite').click(function () {
                FB.ui({
                    method: 'send',
                    name: "You are invited to the group {{ group.name | raw }}",
                    link: 'http://demo.alienwarearena.com/',
                    description: "Check out Alienware Arena's Groups! Join a wide variety of gamer related communities and share your thoughts on your favorite topics.",
                    image: '{{ inviteThumb }}'
                });
            });
        });
    </script>

{% endblock %}
