<!DOCTYPE HTML>
<html xmlns:fb="https://www.facebook.com/2008/fbml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

		<script type="text/javascript">
			var CKEDITOR_BASEPATH = '/ckeditor/';
		</script>

        {% block open_graph %}{% endblock %}

        {# This can never be overriden using the multitheme feature #}
        {# If you want to add css or js for only one theme, use the theme specific assets template #}
        {% include 'SpoutletBundle::base_assets.html.twig' %}

        {# Here we include assets for the current active theme #}
        {% include '::' ~ active_theme ~ '_assets.html.twig' ignore missing %}

        <title>
            {%- if block('title') -%}
                {{ block('title') }} | {{ 'platformd.layout.title_suffix' | trans }}
            {%- else -%}
            {{ 'platformd.layout.default_title' | trans }}
            {%- endif -%}
        </title>

		<script type="text/javascript">

		    $(document).ready(function(){
                $('a[href^="http://"]').not('a[href*=alienwarearena]').attr('target','_blank');
                $('a[href*="alienwarearena"]').attr('target','');

		        $("ul.sf-menu").supersubs({
		            minWidth:   12,
		            maxWidth:   27,
		            extraWidth: 1
		        }).superfish({
					delay:		150
				});

                var width = 0;
                $('ul.sf-menu').children().each(function(){
                    width += ($(this).width() + 10);
                });
                $('#nav-wrapper').width(width);

                $("ul.sf-menu-account").supersubs({
                    minWidth:   12,
                    maxWidth:   27,
                    extraWidth: 1
                }).superfish({
                    delay:      150
                });
		    });
		</script>
		<script type="text/javascript">

			$(document).ready(function(){
				$('#toggleRegion').click(function(e){
                    e.preventDefault();

				    $('#selectRegion').toggle();
				    $('#selectLanguage').hide();
				});

				$('#toggleLanguage').click(function(e){
                    e.preventDefault();

				    $('#selectLanguage').toggle();
				    $('#selectRegion').hide();
				});
			});
		</script>
        {% include 'SpoutletBundle:Default:_prep_google_dfp.html.twig' %}
        {% include 'SpoutletBundle::_analytics.html.twig' %}
	</head>
	<body class="site-{{ app.session.locale }}">
        {% if facebook_app_id %}
        <div id="fb-root"></div>
        <script src="http://connect.facebook.net/en_US/all.js"></script>
        <script>
          // assume we are already logged in
          FB.init({appId: '{{ facebook_app_id }}', xfbml: true, cookie: true});
        </script>
        {% endif %}

		<div id="omni">
            {# big line to add a background-image if the page_background_image block has been set #}
	        <div id="page"{{ (block('page_background_image') ? (' style="background-image: url(\'%url%\');"'|replace({'%url%': block('page_background_image')})) : '') | raw }}>
	            <div class="background-takeover" id="custom_background_top">
	                <div class="background-takeover" id="custom_background_bot">
	                    <div id="header">
	                    	{% include 'SpoutletBundle::header.html.twig' %}
	                    </div>
	                    <div id="mainNav-wrapper">
	                        {% include 'SpoutletBundle::navigation.html.twig' %}
	                    </div>
	                    <div id="content-wrapper">
                            <div id="content-background">
                                <div id="content">
                                    {% block pre_content_nav %}{% endblock %}

                                    {#
                                        Messy, but taken from the old site
                                        To show a flash message, set the "flash" block
                                        to your actual message. Then set the "flash_type"
                                        block to: success, warning, or error

                                        This also works out of the box for "error"
                                        and "success"session flashes - given an "error"
                                        type and the message is dumped out with
                                        some markup

                                        Also, yes, I know this is hideous...
                                    #}

                                    {% if app.session.hasFlash('error') %}
                                        {% set sessionFlashType = 'error' %}
                                    {% elseif (app.session.hasFlash('success')) %}
                                        {% set sessionFlashType = 'success' %}
                                    {% else %}
                                        {% set sessionFlashType = block('flash_type') %}
                                    {% endif %}

                                    {% if  sessionFlashType %}
                                        <div class="xnotices">
                                            <div class="{{ sessionFlashType }}Notice notice">
                                                <div class="pad">
                                                    <div class="pad2">
                                                        <div class="pad3">
                                                            <div class="pad4">
                                                                {#
                                                                    funny, I had to set this as a variable - concatenating
                                                                    and translating the string all in one line was a fail
                                                                #}
                                                                {% set flashTitleKey = 'platformd.flash.'~sessionFlashType~'_title' %}
                                                                <h3>
                                                                    {{ flashTitleKey | trans }}
                                                                </h3>

                                                                {% if app.session.getFlash(sessionFlashType) %}
                                                                    <p>
                                                                        {{ app.session.getFlash(sessionFlashType) | trans }}
                                                                    </p>
                                                                {% else %}
                                                                    {{ block('flash') }}
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    {% endif %}

                                    {% block content %}{% endblock %}
                                </div>
                            </div>
                        </div>
	                    {% include 'SpoutletBundle:Default:_dealsAdBottom.html.twig' %}
                        {% if block('legal_footer') %}
                            <div class="legalese">
                                {{ block('legal_footer') }}
                            </div>
                        {% endif %}
	                    {% include 'SpoutletBundle::footer.html.twig' %}
	                </div>
	            </div>
	        </div>
	    </div>
	</body>
</html>
