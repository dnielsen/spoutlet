{% extends 'SpoutletBundle::layout.html.twig' %}

{% block title 'deals' | trans %}

{% block content %}
{% set dealDeafultImage = '/bundles/spoutlet/images/alienwarelogothumb.png' %}

    {% if mainDeal %}
        {% include 'SpoutletBundle:Deal:_dealHeaderCountdown.html.twig' with { 'deal': mainDeal } %}
    {% endif %}

    <div class="deal-list-page">
        <h1>{{ 'featured_deals' | trans }}</h1>

        <ul class="featured-deals">
            {% for deal in featuredDeals %}
            {% set dealImage = deal.thumbnailLarge ? media_path(deal.thumbnailLarge) : dealDeafultImage %}

                <li>
                    <a href="{{ deal | pd_link }}">
                        <img src="{{ dealImage }}" alt="{{ deal.name }}" />
                    </a>

                    <br/>

                    {{ deal | pd_link_full(deal.name) }}

                    {# todo - run this through the KnpTimeBundle #}
                    {{ 'time_remaining' }}
                </li>
            {% endfor %}
        </ul>

        {% if allDeals %}
            <h1>{{ 'deals' | trans }}</h1>

            <ul class="all-deals">
                {% for deal in allDeals %}
                {% set dealImage = deal.thumbnailLarge ? media_path(deal.thumbnailLarge) : dealDeafultImage %}

                <li>
                    <a href="{{ deal | pd_link }}">
                        <img src="{{ dealImage }}" alt="{{ deal.name }}" />
                    </a>

                    <br/>

                    {{ deal | pd_link_full(deal.name) }}

                    {# todo - run this through the KnpTimeBundle #}
                    {{ 'time_remaining' }}
                </li>
                {% endfor %}
            </ul>
        {% endif %}

        {% if expiredDeals %}
            <h1>{{ 'expired_deals' | trans }}</h1>

            <ul class="expired-deals">
                {% for deal in expiredDeals %}
                {% set dealImage = deal.thumbnailLarge ? media_path(deal.thumbnailLarge) : dealDeafultImage %}

                <li>

                    {# We need to improve this, but it does work #}

                    <div style="background: url({{ dealImage }}); background-repeat: no-repeat; width: 245px; height: 95px;">
                        <a href="{{ deal | pd_link }}" style="width: 245px; height: 95px; display:block;">
                            <img src="/bundles/spoutlet/images/expired.png" alt="deal expired" style="margin-left: 60px;" />
                        </a>
                    </div>


                    <br/>

                    {{ deal | pd_link_full(deal.name) }}
                </li>
                {% endfor %}
            </ul>
        {% endif %}

    </div>

    <div class="clear">&nbsp;</div>

{% endblock %}
