<?php

namespace Application\Migrations;

use Doctrine\DBAL\Migrations\AbstractMigration,
    Doctrine\DBAL\Schema\Schema;

/**
 * Auto-generated Migration: Please modify to your need!
 */
class Version20120831204628 extends AbstractMigration
{
    public function up(Schema $schema)
    {
        // this up() migration is autogenerated, please modify it to your needs
        $this->abortIf($this->connection->getDatabasePlatform()->getName() != "mysql");
        
        $this->addSql("DROP TABLE groupimage_contentreport");
        $this->addSql("DROP TABLE groupnews_contentreport");
        $this->addSql("DROP TABLE groupvideo_contentreport");
        $this->addSql("ALTER TABLE pd_group_image ADD deletedReason VARCHAR(255) DEFAULT NULL");
        $this->addSql("ALTER TABLE pd_group_video ADD deletedReason VARCHAR(255) DEFAULT NULL");
        $this->addSql("ALTER TABLE pd_group_news ADD deletedReason VARCHAR(255) DEFAULT NULL");
        $this->addSql("ALTER TABLE pd_content_report ADD site_id INT NOT NULL, ADD groupImage_id INT DEFAULT NULL, ADD groupNews_id INT DEFAULT NULL, ADD groupVideo_id INT DEFAULT NULL");
        $this->addSql("ALTER TABLE pd_content_report ADD CONSTRAINT FK_E798A78EF6BD1646 FOREIGN KEY (site_id) REFERENCES pd_site(id)");
        $this->addSql("ALTER TABLE pd_content_report ADD CONSTRAINT FK_E798A78E369BF24A FOREIGN KEY (groupImage_id) REFERENCES pd_group_image(id) ON DELETE SET NULL");
        $this->addSql("ALTER TABLE pd_content_report ADD CONSTRAINT FK_E798A78E50AC5F6F FOREIGN KEY (groupNews_id) REFERENCES pd_group_news(id) ON DELETE SET NULL");
        $this->addSql("ALTER TABLE pd_content_report ADD CONSTRAINT FK_E798A78E22FFD769 FOREIGN KEY (groupVideo_id) REFERENCES pd_group_video(id) ON DELETE SET NULL");
        $this->addSql("CREATE INDEX IDX_E798A78EF6BD1646 ON pd_content_report (site_id)");
        $this->addSql("CREATE INDEX IDX_E798A78E369BF24A ON pd_content_report (groupImage_id)");
        $this->addSql("CREATE INDEX IDX_E798A78E50AC5F6F ON pd_content_report (groupNews_id)");
        $this->addSql("CREATE INDEX IDX_E798A78E22FFD769 ON pd_content_report (groupVideo_id)");
    }

    public function down(Schema $schema)
    {
        // this down() migration is autogenerated, please modify it to your needs
        $this->abortIf($this->connection->getDatabasePlatform()->getName() != "mysql");
        
        $this->addSql("CREATE TABLE groupimage_contentreport (groupimage_id INT NOT NULL, contentreport_id INT NOT NULL, INDEX IDX_6EAD52A7CFED901C (groupimage_id), INDEX IDX_6EAD52A737A50B4F (contentreport_id), PRIMARY KEY(groupimage_id, contentreport_id)) ENGINE = InnoDB");
        $this->addSql("CREATE TABLE groupnews_contentreport (groupnews_id INT NOT NULL, contentreport_id INT NOT NULL, INDEX IDX_E2D63A509F1166F3 (groupnews_id), INDEX IDX_E2D63A5037A50B4F (contentreport_id), PRIMARY KEY(groupnews_id, contentreport_id)) ENGINE = InnoDB");
        $this->addSql("CREATE TABLE groupvideo_contentreport (groupvideo_id INT NOT NULL, contentreport_id INT NOT NULL, INDEX IDX_21D99C9CDB89B53F (groupvideo_id), INDEX IDX_21D99C9C37A50B4F (contentreport_id), PRIMARY KEY(groupvideo_id, contentreport_id)) ENGINE = InnoDB");
        $this->addSql("ALTER TABLE groupimage_contentreport ADD CONSTRAINT FK_6EAD52A737A50B4F FOREIGN KEY (contentreport_id) REFERENCES pd_content_report(id) ON DELETE CASCADE");
        $this->addSql("ALTER TABLE groupimage_contentreport ADD CONSTRAINT FK_6EAD52A7CFED901C FOREIGN KEY (groupimage_id) REFERENCES pd_group_image(id) ON DELETE CASCADE");
        $this->addSql("ALTER TABLE groupnews_contentreport ADD CONSTRAINT FK_E2D63A5037A50B4F FOREIGN KEY (contentreport_id) REFERENCES pd_content_report(id) ON DELETE CASCADE");
        $this->addSql("ALTER TABLE groupnews_contentreport ADD CONSTRAINT FK_E2D63A509F1166F3 FOREIGN KEY (groupnews_id) REFERENCES pd_group_news(id) ON DELETE CASCADE");
        $this->addSql("ALTER TABLE groupvideo_contentreport ADD CONSTRAINT FK_21D99C9C37A50B4F FOREIGN KEY (contentreport_id) REFERENCES pd_content_report(id) ON DELETE CASCADE");
        $this->addSql("ALTER TABLE groupvideo_contentreport ADD CONSTRAINT FK_21D99C9CDB89B53F FOREIGN KEY (groupvideo_id) REFERENCES pd_group_video(id) ON DELETE CASCADE");
        $this->addSql("ALTER TABLE pd_content_report DROP FOREIGN KEY FK_E798A78EF6BD1646");
        $this->addSql("ALTER TABLE pd_content_report DROP FOREIGN KEY FK_E798A78E369BF24A");
        $this->addSql("ALTER TABLE pd_content_report DROP FOREIGN KEY FK_E798A78E50AC5F6F");
        $this->addSql("ALTER TABLE pd_content_report DROP FOREIGN KEY FK_E798A78E22FFD769");
        $this->addSql("DROP INDEX IDX_E798A78EF6BD1646 ON pd_content_report");
        $this->addSql("DROP INDEX IDX_E798A78E369BF24A ON pd_content_report");
        $this->addSql("DROP INDEX IDX_E798A78E50AC5F6F ON pd_content_report");
        $this->addSql("DROP INDEX IDX_E798A78E22FFD769 ON pd_content_report");
        $this->addSql("ALTER TABLE pd_content_report DROP site_id, DROP groupImage_id, DROP groupNews_id, DROP groupVideo_id");
        $this->addSql("ALTER TABLE pd_group_image DROP deletedReason");
        $this->addSql("ALTER TABLE pd_group_news DROP deletedReason");
        $this->addSql("ALTER TABLE pd_group_video DROP deletedReason");
    }
}
