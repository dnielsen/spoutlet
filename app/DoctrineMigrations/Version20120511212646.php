<?php

namespace Application\Migrations;

use Doctrine\DBAL\Migrations\AbstractMigration,
    Doctrine\DBAL\Schema\Schema;

/**
 * Auto-generated Migration: Please modify to your need!
 */
class Version20120511212646 extends AbstractMigration
{
    public function up(Schema $schema)
    {
        // this up() migration is autogenerated, please modify it to your needs
        $this->abortIf($this->connection->getDatabasePlatform()->getName() != "mysql");
        
        $this->addSql("CREATE TABLE pd_game_page (id INT AUTO_INCREMENT NOT NULL, game_id INT NOT NULL, slug VARCHAR(255) NOT NULL, locale VARCHAR(255) NOT NULL, button_image1 VARCHAR(255) DEFAULT NULL, button_image2 VARCHAR(255) DEFAULT NULL, aboutGame LONGTEXT DEFAULT NULL, keyFeature1 LONGTEXT DEFAULT NULL, keyFeature2 LONGTEXT DEFAULT NULL, keyFeature3 LONGTEXT DEFAULT NULL, youtubeTrailer1 VARCHAR(255) DEFAULT NULL, youtubeIdTrailer2 VARCHAR(255) DEFAULT NULL, youtubeIdTrailer3 VARCHAR(255) DEFAULT NULL, youtubeIdTrailer4 VARCHAR(255) DEFAULT NULL, legalVerbiage LONGTEXT DEFAULT NULL, buttonImage1_id INT DEFAULT NULL, buttonImage2_id INT DEFAULT NULL, backgroundImage_id INT DEFAULT NULL, INDEX IDX_EE9BB146E48FD905 (game_id), INDEX IDX_EE9BB146830ED347 (buttonImage1_id), INDEX IDX_EE9BB14691BB7CA9 (buttonImage2_id), INDEX IDX_EE9BB146745FB76C (backgroundImage_id), UNIQUE INDEX slug_unique (slug, locale), PRIMARY KEY(id)) ENGINE = InnoDB");
        $this->addSql("ALTER TABLE pd_game_page ADD CONSTRAINT FK_EE9BB146E48FD905 FOREIGN KEY (game_id) REFERENCES pd_game(id) ON DELETE CASCADE");
        $this->addSql("ALTER TABLE pd_game_page ADD CONSTRAINT FK_EE9BB146830ED347 FOREIGN KEY (buttonImage1_id) REFERENCES pd_media(id) ON DELETE SET NULL");
        $this->addSql("ALTER TABLE pd_game_page ADD CONSTRAINT FK_EE9BB14691BB7CA9 FOREIGN KEY (buttonImage2_id) REFERENCES pd_media(id) ON DELETE SET NULL");
        $this->addSql("ALTER TABLE pd_game_page ADD CONSTRAINT FK_EE9BB146745FB76C FOREIGN KEY (backgroundImage_id) REFERENCES pd_media(id) ON DELETE SET NULL");
        $this->addSql("CREATE UNIQUE INDEX slug_unique ON pd_game (slug, locale)");
    }

    public function down(Schema $schema)
    {
        // this down() migration is autogenerated, please modify it to your needs
        $this->abortIf($this->connection->getDatabasePlatform()->getName() != "mysql");

        $this->addSql("DROP TABLE pd_game_page");
        $this->addSql("DROP INDEX slug_unique ON pd_game");
    }
}
